<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Python Fundamentals Quiz</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
        .correct-answer {
            background-color: #d1fae5;
            border-color: #10b981;
        }
        .incorrect-answer {
            background-color: #fee2e2;
            border-color: #ef4444;
        }
        .matching-choice {
            cursor: pointer;
            transition: background-color 0.2s, transform 0.2s;
        }
        .matching-choice:hover:not(.selected) {
            background-color: #e5e7eb;
        }
        .matching-choice.selected {
            background-color: #d1d5db;
            border-color: #6b7280;
            transform: scale(1.02);
        }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen p-4">

<div id="quiz-container" class="bg-white rounded-lg shadow-xl p-8 max-w-4xl w-full">

    <!-- Start Screen -->
    <div id="start-screen" class="text-center transition-opacity duration-500 ease-in-out opacity-100">
        <h1 class="text-4xl font-bold mb-4 text-gray-800">Python Fundamentals Quiz</h1>
        <p class="text-gray-600 mb-8">Test your knowledge on Python fundamentals with 120 questions across three sections: Multiple Choice, True/False, and Matching Type.</p>
        <button id="start-btn" class="px-6 py-3 bg-indigo-600 text-white font-semibold rounded-full shadow-lg hover:bg-indigo-700 transition duration-300 transform hover:scale-105">Start Quiz</button>
    </div>

    <!-- Quiz Screen -->
    <div id="quiz-screen" class="hidden">
        <div class="flex justify-between items-center mb-6 border-b pb-4">
            <div id="progress" class="text-lg font-medium text-gray-700">Question 1 of 120</div>
            <div id="section-label" class="text-lg font-medium text-gray-700">Multiple Choice</div>
        </div>

        <!-- Question Area -->
        <div id="question-area" class="mb-8">
            <h2 id="question-text" class="text-2xl font-semibold mb-4 text-gray-800"></h2>
            <div id="options-container" class="grid grid-cols-1 gap-4"></div>
        </div>
        <button id="next-btn" class="w-full px-6 py-3 bg-indigo-600 text-white font-semibold rounded-full shadow-lg hover:bg-indigo-700 transition duration-300 transform hover:scale-105">Next</button>
    </div>

    <!-- Results Screen -->
    <div id="results-screen" class="hidden">
        <h2 class="text-3xl font-bold mb-4 text-center text-gray-800">Quiz Complete!</h2>
        <div class="text-center mb-6">
            <p class="text-2xl font-medium text-gray-700">Your Score:</p>
            <p id="score-display" class="text-5xl font-bold text-indigo-600 mt-2">0 / 120</p>
            <p class="text-2xl font-medium text-gray-700 mt-4">Your Grade:</p>
            <p id="grade-display" class="text-4xl font-bold text-indigo-600 mt-2">G</p>
        </div>
        <div id="incorrect-answers" class="space-y-6">
            <h3 class="text-xl font-bold border-b pb-2 text-gray-800">Incorrect Answers:</h3>
        </div>
        <button onclick="location.reload()" class="w-full mt-8 px-6 py-3 bg-indigo-600 text-white font-semibold rounded-full shadow-lg hover:bg-indigo-700 transition duration-300 transform hover:scale-105">Retake Quiz</button>
    </div>

</div>

<script>
    const allQuestions = {
        mc: [
            { id: 1, question: "What is the correct syntax to create a dictionary in Python?", options: ["A. `dict = {key: value}`", "B. `dict = (key: value)`", "C. `dict = [key: value]`", "D. `dict = {key = value}`"], answer: "A" },
            { id: 2, question: "Given a list `fruits = ['apple', 'banana', 'cherry']`, what will `fruits[1]` return?", options: ["A. 'apple'", "B. 'banana'", "C. 'cherry'", "D. Error"], answer: "B" },
            { id: 3, question: "Which of the following is used to handle exceptions in Python?", options: ["A. `catch...finally`", "B. `try...catch`", "C. `error...handle`", "D. `try...except`"], answer: "D" },
            { id: 4, question: "What does the `pass` statement do?", options: ["A. Exits a loop", "B. Skips the current iteration", "C. Is a null operation, nothing happens", "D. Defines a new function"], answer: "C" },
            { id: 5, question: "How do you create a function in Python?", options: ["A. `create my_function():`", "B. `def my_function():`", "C. `function my_function():`", "D. `func my_function():`"], answer: "B" },
            { id: 6, question: "What is the output of `print(type([]))`?", options: ["A. `<class 'list'>`", "B. `<class 'array'>`", "C. `<class 'tuple'>`", "D. `<class 'object'>`"], answer: "A" },
            { id: 7, question: "Which operator is used for exponentiation?", options: ["A. `^`", "B. `**`", "C. `%`", "D. `//`"], answer: "B" },
            { id: 8, question: "What is the purpose of the `elif` keyword?", options: ["A. To handle exceptions", "B. To start a new loop", "C. To check another condition if the previous one was false", "D. To define a constant variable"], answer: "C" },
            { id: 9, question: "What does `x = 5; x += 3;` result in?", options: ["A. 5", "B. 3", "C. 8", "D. 15"], answer: "C" },
            { id: 10, question: "Which of the following is a mutable data type?", options: ["A. String", "B. Tuple", "C. Integer", "D. List"], answer: "D" },
            { id: 11, question: "How do you add an element to a set?", options: ["A. `set.add(item)`", "B. `set.append(item)`", "C. `set.insert(item)`", "D. `set.push(item)`"], answer: "A" },
            { id: 12, question: "What is the output of `print('hello'[1])`?", options: ["A. h", "B. e", "C. l", "D. o"], answer: "B" },
            { id: 13, question: "Which of the following loops is ideal for iterating through a sequence?", options: ["A. `while` loop", "B. `do-while` loop", "C. `for` loop", "D. `repeat` loop"], answer: "C" },
            { id: 14, question: "What does the `in` keyword do?", options: ["A. Checks if an item is a number", "B. Checks if an item exists in a sequence", "C. Converts an item to an integer", "D. Defines a new variable"], answer: "B" },
            { id: 15, question: "What is a docstring?", options: ["A. A comment for a single line", "B. A multiline comment", "C. A string literal to document a module, function, or class", "D. An error message"], answer: "C" },
            { id: 16, question: "What is the purpose of a constructor in a class?", options: ["A. To delete an object", "B. To define the object's methods", "C. To initialize the object's state", "D. To create a new class"], answer: "C" },
            { id: 17, question: "How can you get the length of a string `s`?", options: ["A. `s.length()`", "B. `length(s)`", "C. `len(s)`", "D. `s.size()`"], answer: "C" },
            { id: 18, question: "What is the output of `print(10 / 2)`?", options: ["A. 5", "B. 5.0", "C. 2", "D. 10"], answer: "B" },
            { id: 19, question: "Which of the following statements is used to exit from a function?", options: ["A. `break`", "B. `continue`", "C. `exit`", "D. `return`"], answer: "D" },
            { id: 20, question: "What is a `TypeError`?", options: ["A. An error when trying to divide by zero", "B. An error when a variable is not defined", "C. An error for invalid operation on a data type", "D. An error due to incorrect indentation"], answer: "C" },
            { id: 21, question: "How do you define a constant in Python?", options: ["A. `const MY_CONSTANT = 10`", "B. `MY_CONSTANT = 10` (by convention)", "C. `define MY_CONSTANT 10`", "D. Python does not support constants"], answer: "B" },
            { id: 22, question: "What is the purpose of `pip`?", options: ["A. Python's default IDE", "B. A package installer for Python", "C. A Python code formatter", "D. Python's standard library"], answer: "B" },
            { id: 23, question: "What is the output of `print(3 * 'ab')`?", options: ["A. `ababab`", "B. `ab3`", "C. `ab ab ab`", "D. Error"], answer: "A" },
            { id: 24, question: "Which of the following is a valid way to write a single-line comment?", options: ["A. `// This is a comment`", "B. `<!-- This is a comment -->`", "C. `# This is a comment`", "D. `/* This is a comment */`"], answer: "C" },
            { id: 25, question: "What is the difference between `list.append()` and `list.extend()`?", options: ["A. `append` adds an element, `extend` adds elements of an iterable", "B. `append` adds multiple elements, `extend` adds one", "C. They are identical", "D. `append` is for strings, `extend` is for lists"], answer: "A" },
            { id: 26, question: "What is `__init__` method in a class?", options: ["A. A method to initialize a new object", "B. A method to define a new class", "C. A method to delete an object", "D. A method to import modules"], answer: "A" },
            { id: 27, question: "What is a global variable?", options: ["A. A variable only accessible inside a function", "B. A variable accessible from anywhere in the program", "C. A variable used to store an error", "D. A variable used for loops"], answer: "B" },
            { id: 28, question: "Which of these is not a built-in Python data type?", options: ["A. `array`", "B. `list`", "C. `tuple`", "D. `dict`"], answer: "A" },
            { id: 29, question: "What is the output of `print(10 > 5 and 5 < 10)`?", options: ["A. `True`", "B. `False`", "C. `None`", "D. `Error`"], answer: "A" },
            { id: 30, question: "How do you import a module named `math`?", options: ["A. `use math`", "B. `include math`", "C. `import math`", "D. `get math`"], answer: "C" },
            { id: 31, question: "What is `len('Python')`?", options: ["A. 6", "B. 7", "C. 5", "D. Error"], answer: "A" },
            { id: 32, question: "What is a `tuple`?", options: ["A. A mutable sequence", "B. An immutable sequence", "C. A collection of key-value pairs", "D. An unordered collection of unique elements"], answer: "B" },
            { id: 33, question: "What is the result of `3 % 2`?", options: ["A. 1", "B. 1.5", "C. 0", "D. 2"], answer: "A" },
            { id: 34, question: "Which function converts a value to an integer?", options: ["A. `int()`", "B. `str()`", "C. `float()`", "D. `list()`"], answer: "A" },
            { id: 35, question: "What is the purpose of `try...except` block?", options: ["A. To define a new function", "B. To handle syntax errors", "C. To catch and handle runtime errors", "D. To iterate over a list"], answer: "C" },
            { id: 36, question: "How do you access a value in a dictionary?", options: ["A. `my_dict[key]`", "B. `my_dict.key`", "C. `my_dict->key`", "D. `my_dict(key)`"], answer: "A" },
            { id: 37, question: "What is the correct way to call a function named `my_func`?", options: ["A. `call my_func`", "B. `my_func()`", "C. `my_func`", "D. `execute my_func`"], answer: "B" },
            { id: 38, question: "What is the output of `print(5 == '5')`?", options: ["A. `True`", "B. `False`", "C. `Error`", "D. `None`"], answer: "B" },
            { id: 39, question: "Which of the following is not a valid comparison operator?", options: ["A. `>`", "B. `is`", "C. `!=`", "D. `~`"], answer: "D" },
            { id: 40, question: "What does the `break` statement do?", options: ["A. Ends the function", "B. Skips the current iteration of a loop", "C. Terminates the current loop", "D. Starts a new loop"], answer: "C" },
            { id: 41, question: "How do you check if a variable `x` is of type integer?", options: ["A. `type(x) == 'int'`", "B. `isinstance(x, int)`", "C. `typeof(x) == 'int'`", "D. `x.is_int()`"], answer: "B" },
            { id: 42, question: "What is a class in Python?", options: ["A. A function that returns a value", "B. A blueprint for creating objects", "C. A data structure that stores unique elements", "D. A file that contains Python code"], answer: "B" },
            { id: 43, question: "What is the correct way to declare a function with a default parameter value?", options: ["A. `def my_func(a=10):`", "B. `def my_func(a=default 10):`", "C. `def my_func(a):`", "D. `def my_func(a = def 10):`"], answer: "A" },
            { id: 44, question: "What is the output of `print(bool(0))`?", options: ["A. `True`", "B. `False`", "C. `None`", "D. `0`"], answer: "B" },
            { id: 45, question: "What does `return` do inside a function?", options: ["A. Stops the function's execution and returns a value", "B. Restarts the function from the beginning", "C. Prints a message to the console", "D. Defines a new variable"], answer: "A" }
        ],
        tf: [
            { id: 46, statement: "Python is a case-sensitive language.", answer: "True" },
            { id: 47, statement: "`list` is a mutable data type.", answer: "True" },
            { id: 48, statement: "The `range()` function is used to create a sequence of integers.", answer: "True" },
            { id: 49, statement: "The `+` operator can be used to concatenate a string and an integer.", answer: "False" },
            { id: 50, statement: "Indentation is not a requirement for Python syntax.", answer: "False" },
            { id: 51, statement: "You can change the items in a tuple after it's created.", answer: "False" },
            { id: 52, statement: "The `//` operator performs float division.", answer: "False" },
            { id: 53, statement: "A `dictionary` is an ordered collection of items.", answer: "False" },
            { id: 54, statement: "The `continue` statement skips the rest of the code inside the loop for the current iteration and moves to the next one.", answer: "True" },
            { id: 55, statement: "You can define an `else` block without an `if` statement.", answer: "False" },
            { id: 56, statement: "A `set` cannot contain duplicate items.", answer: "True" },
            { id: 57, statement: "The `is` operator checks for identity (same object in memory).", answer: "True" },
            { id: 58, statement: "A function must always return a value.", answer: "False" },
            { id: 59, statement: "The `input()` function returns a value of type `str`.", answer: "True" },
            { id: 60, statement: "`try`, `except`, and `finally` are used to handle exceptions.", answer: "True" },
            { id: 61, statement: "A string in Python is an immutable sequence of characters.", answer: "True" },
            { id: 62, statement: "`NameError` is raised when a variable is not defined.", answer: "True" },
            { id: 63, statement: "You can use a `for` loop to iterate through a dictionary's keys.", answer: "True" },
            { id: 64, statement: "The `pass` statement is essential for functions that return no value.", answer: "False" },
            { id: 65, statement: "Python is a dynamically typed language.", answer: "True" },
            { id: 66, statement: "The `del` keyword can be used to remove items from a list.", answer: "True" },
            { id: 67, statement: "The `range(5)` function generates numbers from 1 to 5.", answer: "False" },
            { id: 68, statement: "A function can have multiple `return` statements.", answer: "True" },
            { id: 69, statement: "The `%` operator returns the remainder of a division.", answer: "True" },
            { id: 70, statement: "The `str()` function is used to convert a number to a string.", answer: "True" },
            { id: 71, statement: "The `and` operator returns `True` if at least one condition is true.", answer: "False" },
            { id: 72, statement: "A `while` loop checks its condition at the end of the loop.", answer: "False" },
            { id: 73, statement: "The `import` statement is used to bring modules into a program.", answer: "True" },
            { id: 74, statement: "A class in Python is a blueprint for creating objects.", answer: "True" },
            { id: 75, statement: "Method overloading is a concept where multiple methods have the same name but different parameters.", answer: "True" },
            { id: 76, statement: "Inheritance allows a new class to inherit properties from an existing class.", answer: "True" },
            { id: 77, statement: "A `ValueError` is raised when a function receives an argument of the correct type but an inappropriate value.", answer: "True" },
            { id: 78, statement: "The `+` operator for lists creates a new list by concatenating two lists.", answer: "True" },
            { id: 79, statement: "The `sorted()` function sorts a list in-place and returns `None`.", answer: "False" },
            { id: 80, statement: "A `for` loop is considered more robust and readable than a `while` loop for simple iterations.", answer: "True" },
            { id: 81, statement: "A `global` keyword is needed to modify a global variable inside a function.", answer: "True" },
            { id: 82, statement: "Python is a compiled language.", answer: "False" },
            { id: 83, statement: "You can access elements of a dictionary using their index.", answer: "False" },
            { id: 84, statement: "An object is an instance of a class.", answer: "True" },
            { id: 85, statement: "Polymorphism allows objects of different classes to be treated as objects of a common superclass.", answer: "True" },
            { id: 86, statement: "A `try` block must be followed by at least one `except` or `finally` block.", answer: "True" },
            { id: 87, statement: "The `f-string` is a way to format strings using expressions.", answer: "True" },
            { id: 88, statement: "Python's standard library is a small collection of essential modules.", answer: "False" },
            { id: 89, statement: "A `list` can contain elements of different data types.", answer: "True" },
            { id: 90, statement: "The `finally` block of a `try...except` statement is always executed, even if an exception occurs.", answer: "True" }
        ],
        matching: [
            { id: 91, term: "List", matchId: "C" },
            { id: 92, term: "Tuple", matchId: "B" },
            { id: 93, term: "Dictionary", matchId: "A" },
            { id: 94, term: "`if`/`elif`/`else`", matchId: "D" },
            { id: 95, term: "`for` loop", matchId: "G" },
            { id: 96, term: "`while` loop", matchId: "I" },
            { id: 97, term: "Function", matchId: "F" },
            { id: 98, term: "`def`", matchId: "E" },
            { id: 99, term: "`return`", matchId: "H" },
            { id: 100, term: "Modulus operator", matchId: "K" },
            { id: 101, term: "Floor division", matchId: "J" },
            { id: 102, term: "String slicing", matchId: "N" },
            { id: 103, term: "`append()`", matchId: "L" },
            { id: 104, term: "`pop()`", matchId: "M" },
            { id: 105, term: "`len()`", matchId: "P" },
            { id: 106, term: "`in` operator", matchId: "Q" },
            { id: 107, term: "Boolean", matchId: "O" },
            { id: 108, term: "Float", matchId: "S" },
            { id: 109, term: "Integer", matchId: "R" },
            { id: 110, term: "`continue`", matchId: "U" },
            { id: 111, term: "`break`", matchId: "T" },
            { id: 112, term: "`pass`", matchId: "V" },
            { id: 113, term: "`input()`", matchId: "W" },
            { id: 114, term: "Set", matchId: "Y" },
            { id: 115, term: "Key-value pair", matchId: "X" },
            { id: 116, term: "Identity operator", matchId: "Z" },
            { id: 117, term: "Logical operator", matchId: "AA" },
            { id: 118, term: "Comparison operator", matchId: "AB" },
            { id: 119, term: "F-string", matchId: "AC" },
            { id: 120, term: "`range()`", matchId: "AD" },
        ],
        matchingAnswers: [
            { id: "A", text: "Mutable collection of key-value pairs" },
            { id: "B", text: "Immutable ordered sequence" },
            { id: "C", text: "Mutable ordered sequence" },
            { id: "D", text: "Conditional statements" },
            { id: "E", text: "Keyword to define a function" },
            { id: "F", text: "A block of reusable code" },
            { id: "G", text: "Used to iterate over a sequence" },
            { id: "H", text: "Sends a value back from a function" },
            { id: "I", text: "Executes a block of code as long as a condition is true" },
            { id: "J", text: "Divides and returns the integer part" },
            { id: "K", text: "Returns the remainder of a division" },
            { id: "L", text: "Method to add an item to the end of a list" },
            { id: "M", text: "Method to remove and return the last item of a list" },
            { id: "N", text: "Extracting a part of a sequence" },
            { id: "O", text: "Data type with values True or False" },
            { id: "P", text: "Function to get the length of an object" },
            { id: "Q", text: "Checks if a value is present in a sequence" },
            { id: "R", text: "A whole number without a decimal point" },
            { id: "S", text: "A number with a decimal point" },
            { id: "T", text: "Terminates the current loop" },
            { id: "U", text: "Skips the current iteration of a loop" },
            { id: "V", text: "A placeholder statement that does nothing" },
            { id: "W", text: "Function to get user input" },
            { id: "X", text: "A fundamental concept of dictionaries" },
            { id: "Y", text: "Unordered collection of unique elements" },
            { id: "Z", text: "Used to check if two variables point to the same object" },
            { id: "AA", text: "Examples include `and`, `or`, `not`" },
            { id: "AB", text: "Examples include `==`, `!=`, `<`, `>`" },
            { id: "AC", text: "A way to format strings with embedded expressions" },
            { id: "AD", text: "Generates a sequence of numbers" },
        ]
    };

    let questions = [
        ...allQuestions.mc,
        ...allQuestions.tf,
        ...allQuestions.matching
    ];

    let currentQuestionIndex = 0;
    let score = 0;
    let userAnswers = [];

    const startScreen = document.getElementById('start-screen');
    const quizScreen = document.getElementById('quiz-screen');
    const resultsScreen = document.getElementById('results-screen');
    const startBtn = document.getElementById('start-btn');
    const nextBtn = document.getElementById('next-btn');
    const progressDisplay = document.getElementById('progress');
    const sectionLabel = document.getElementById('section-label');
    const questionText = document.getElementById('question-text');
    const optionsContainer = document.getElementById('options-container');
    const scoreDisplay = document.getElementById('score-display');
    const gradeDisplay = document.getElementById('grade-display');
    const incorrectAnswersList = document.getElementById('incorrect-answers');

    startBtn.addEventListener('click', startQuiz);
    nextBtn.addEventListener('click', nextQuestion);

    function startQuiz() {
        startScreen.classList.add('opacity-0');
        setTimeout(() => {
            startScreen.classList.add('hidden');
            quizScreen.classList.remove('hidden');
            quizScreen.classList.add('opacity-100');
            loadQuestion();
        }, 500);
    }

    function loadQuestion() {
        if (currentQuestionIndex >= questions.length) {
            submitQuiz();
            return;
        }

        const currentQuestion = questions[currentQuestionIndex];
        progressDisplay.textContent = `Question ${currentQuestion.id} of 120`;
        optionsContainer.innerHTML = '';
        nextBtn.disabled = true;

        if (currentQuestion.id <= 45) {
            sectionLabel.textContent = "Multiple Choice";
            // Multiple Choice
            questionText.textContent = `${currentQuestion.id}. ${currentQuestion.question}`;
            optionsContainer.classList.remove('grid-cols-1', 'gap-4');
            optionsContainer.classList.add('grid-cols-2', 'gap-8');
            currentQuestion.options.forEach(option => {
                const button = document.createElement('button');
                button.textContent = option;
                button.className = 'w-full text-left py-3 px-4 border border-gray-300 rounded-lg shadow-sm bg-gray-50 hover:bg-gray-200 transition duration-150 ease-in-out';
                button.addEventListener('click', () => {
                    selectAnswer(button, option);
                    nextBtn.disabled = false;
                });
                optionsContainer.appendChild(button);
            });
        } else if (currentQuestion.id <= 90) {
            sectionLabel.textContent = "True / False";
            // True/False
            questionText.textContent = `${currentQuestion.id}. ${currentQuestion.statement}`;
            optionsContainer.classList.remove('grid-cols-2', 'gap-8');
            optionsContainer.classList.add('grid-cols-2', 'gap-8');
            ['True', 'False'].forEach(option => {
                const button = document.createElement('button');
                button.textContent = option;
                button.className = 'w-full py-3 px-4 border border-gray-300 rounded-lg shadow-sm bg-gray-50 hover:bg-gray-200 transition duration-150 ease-in-out';
                button.addEventListener('click', () => {
                    selectAnswer(button, option);
                    nextBtn.disabled = false;
                });
                optionsContainer.appendChild(button);
            });
        } else {
            sectionLabel.textContent = "Matching Type";
            // Matching Type
            questionText.textContent = `${currentQuestion.id}. ${currentQuestion.term}`;
            optionsContainer.classList.remove('grid-cols-2', 'gap-8');
            optionsContainer.classList.add('grid-cols-1', 'gap-4');

            const select = document.createElement('select');
            select.className = 'w-full p-3 border border-gray-300 rounded-lg shadow-sm focus:ring-indigo-500 focus:border-indigo-500';
            select.innerHTML = '<option value="" disabled selected>Select a matching answer</option>';

            const shuffledAnswers = [...allQuestions.matchingAnswers].sort(() => Math.random() - 0.5);
            shuffledAnswers.forEach(match => {
                const option = document.createElement('option');
                option.value = match.id;
                option.textContent = `${match.id}. ${match.text}`;
                select.appendChild(option);
            });

            select.addEventListener('change', (e) => {
                questions[currentQuestionIndex].userAnswer = e.target.value;
                nextBtn.disabled = false;
            });
            optionsContainer.appendChild(select);
        }
    }

    function selectAnswer(button, selected) {
        optionsContainer.querySelectorAll('button').forEach(btn => {
            btn.classList.remove('bg-gray-200');
            btn.classList.add('bg-gray-50');
        });
        button.classList.remove('bg-gray-50');
        button.classList.add('bg-gray-200');
        questions[currentQuestionIndex].userAnswer = selected;
    }

    function nextQuestion() {
        const currentQuestion = questions[currentQuestionIndex];
        let isCorrect = false;

        if (currentQuestion.id <= 90) {
            // MC and T/F
            if (currentQuestion.userAnswer && currentQuestion.userAnswer.includes(currentQuestion.answer)) {
                score++;
                isCorrect = true;
            }
        } else {
            // Matching
            if (currentQuestion.userAnswer && currentQuestion.userAnswer.includes(currentQuestion.matchId)) {
                score++;
                isCorrect = true;
            }
        }

        userAnswers.push({
            id: currentQuestion.id,
            question: currentQuestion.question || currentQuestion.statement || currentQuestion.term,
            type: currentQuestion.id <= 45 ? 'mc' : (currentQuestion.id <= 90 ? 'tf' : 'matching'),
            userAnswer: currentQuestion.userAnswer,
            correctAnswer: currentQuestion.id <= 90 ? currentQuestion.answer : currentQuestion.matchId
        });

        currentQuestionIndex++;
        loadQuestion();
        if (currentQuestionIndex === questions.length) {
            nextBtn.textContent = 'Finish Quiz';
        }
    }

    function submitQuiz() {
        quizScreen.classList.add('hidden');
        resultsScreen.classList.remove('hidden');
        scoreDisplay.textContent = `${score} / 120`;

        const grade = (score / 120) * 50 + 50;
        gradeDisplay.textContent = grade.toFixed(2);

        displayIncorrectAnswers();
    }

    function displayIncorrectAnswers() {
        const incorrects = userAnswers.filter(q => {
            const currentQuestion = questions.find(item => item.id === q.id);
            if (q.type === 'mc' || q.type === 'tf') {
                return !q.userAnswer || !q.userAnswer.includes(currentQuestion.answer);
            } else {
                return !q.userAnswer || !q.userAnswer.includes(currentQuestion.matchId);
            }
        });

        if (incorrects.length === 0) {
            const p = document.createElement('p');
            p.textContent = "Congratulations! You got all the questions right.";
            p.className = 'text-center text-green-600 font-semibold mt-4';
            incorrectAnswersList.appendChild(p);
        } else {
            incorrects.forEach(q => {
                const div = document.createElement('div');
                div.className = 'p-4 rounded-lg border-2 incorrect-answer';

                const questionP = document.createElement('p');
                questionP.className = 'font-semibold mb-2';
                questionP.textContent = `${q.id}. ${q.question}`;
                div.appendChild(questionP);

                const yourAnswerP = document.createElement('p');
                yourAnswerP.className = 'text-sm text-gray-700';
                const userAnswerText = q.type === 'matching' ? allQuestions.matchingAnswers.find(item => item.id === q.userAnswer)?.text : q.userAnswer;
                yourAnswerP.innerHTML = `<strong>Your Answer:</strong> ${userAnswerText || 'Not answered'}`;
                div.appendChild(yourAnswerP);

                const correctAnswerP = document.createElement('p');
                correctAnswerP.className = 'text-sm text-gray-700 mt-1';
                const correctAnswerText = q.type === 'matching' ? allQuestions.matchingAnswers.find(item => item.id === q.correctAnswer)?.text : q.correctAnswer;
                correctAnswerP.innerHTML = `<strong>Correct Answer:</strong> ${correctAnswerText}`;
                div.appendChild(correctAnswerP);

                incorrectAnswersList.appendChild(div);
            });
        }
    }
</script>
</body>
</html>
